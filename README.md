# GuardianVision
Tienda virtual de venta de cámaras


Abrimos una terminal en la capeta raiz del proyecto y ejecutamos

1.- npm install

2.- composer istall

3.- le damos a todo enter y al final en la confirmacion le damos a que si por lo que se nos ha creado un documento .json

4.- Añadir esto al archivo composer.json:

    "autoload": {
        "psr-4": {
            "MVC\\": "./",
            "Controllers\\": "./controllers",
            "Model\\": "./models"
        }
    },

5.- Tras hacer esto en una terminal ponemos:

    composer dump-autoload

    composer install

5- Con eso ya deberiamos poder ejecutarlo 

    - En una terminal poner => npm run dev 


    - En otra terminal poner=>
    Pero antes IMP tienes que cambiar de caperta =>

    cd public
    php -S localhost:3000


    BASE DE DATOS 

    -- MySQL Script generated by MySQL Workbench
-- Mon May 12 20:22:11 2025
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering
-- -----------------------------------------------------
-- Schema guardianvision
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema guardianvision
-- -----------------------------------------------------

CREATE database guardianvision;

USE guardianvision;

-- -----------------------------------------------------
-- Table `guardianvision`.`Almacen`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Almacen (
  id_almacen INT NOT NULL PRIMARY KEY auto_increment,
  nombre VARCHAR(100) NOT NULL,
  direccion VARCHAR(200) NOT NULL,
  capacidad INT NOT NULL,
  capacidad_ocupada INT NOT NULL
);

describe Almacen;

drop table Almacen;

-- -----------------------------------------------------
-- Table `guardianvision`.`Producto`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Producto (
  cod_producto VARCHAR(20) NOT NULL PRIMARY KEY,
  nombre VARCHAR(100) NOT NULL,
  stock_actual INT NOT NULL,
  stock_minimo INT NOT NULL,
  precio DECIMAL(10,2) NOT NULL,
  ubicacion INT NOT NULL,
  descripcion varchar(200) not null,
  FOREIGN KEY (ubicacion) REFERENCES Almacen(id_almacen)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

describe producto;

drop table producto;

-- -----------------------------------------------------
-- Table `guardianvision`.`Movimiento_Almacen`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Movimiento_Almacen (
  id_movimiento INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  tipo ENUM('entrada', 'salida') NOT NULL,
  fecha DATE NOT NULL,
  producto_id VARCHAR(20) NOT NULL,
  cantidad INT NOT NULL,
  almacen_id INT NOT NULL,
  origen_operacion ENUM('compra', 'venta') NOT NULL,
  FOREIGN KEY (producto_id) REFERENCES Producto(cod_producto),
  FOREIGN KEY (almacen_id) REFERENCES Almacen(id_almacen)
);

DESCRIBE movimiento_almacen;

DROP table Movimiento_Almacen;

-- -----------------------------------------------------
-- Table `guardianvision`.`proveedor`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS proveedor (
  cod_proveedor VARCHAR(20) NOT NULL PRIMARY KEY,
  razon_social VARCHAR(15) NOT NULL,
  direccion VARCHAR(100) NOT NULL,
  telefono VARCHAR(15) NOT NULL,
  email VARCHAR(34) NOT NULL
);

DESCRIBE proveedor;

DROP table proveedor;


-- -----------------------------------------------------
-- Table `guardianvision`.`Materia_Prima`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Materia_Prima (
  cod_mp VARCHAR(20) NOT NULL PRIMARY KEY,
  nombre VARCHAR(100) NOT NULL,
  unidad_medida VARCHAR(20),
  stock_actuall INT NOT NULL,
  stock_minimo INT NOT NULL,
  proveedor VARCHAR(100),
  ubicacion INT NOT NULL,
  FOREIGN KEY (proveedor) REFERENCES proveedor(cod_proveedor),
  FOREIGN KEY (ubicacion) REFERENCES Almacen(id_almacen)
);

DESCRIBE Materia_Prima;

DROP table Materia_Prima;


-- -----------------------------------------------------
-- Table `guardianvision`.`Empresa`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Empresa (
  razon_social VARCHAR(100) NOT NULL,
  nif VARCHAR(15) NOT NULL PRIMARY KEY,
  direccion VARCHAR(200) NOT NULL,
  telefono VARCHAR(15) NOT NULL,
  email VARCHAR(100) NOT NULL
);

DESCRIBE Empresa;

DROP table Empresa;


-- -----------------------------------------------------
-- Table `guardianvision`.`Configuracion_General`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Configuracion_General (
  moneda VARCHAR(10) NOT NULL,
  idioma VARCHAR(20) NOT NULL,
  pais VARCHAR(50) NOT NULL
);


DESCRIBE Configuracion_General;

DROP table Configuracion_General;


-- -----------------------------------------------------
-- Table `guardianvision`.`Configuracion_IVA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Configuracion_IVA (
  porcentaje_iva DECIMAL(4,2) NOT NULL,
  fecha_ini_iva DATE NOT NULL PRIMARY KEY,
  fecha_fin_iva DATE
);

DESCRIBE Configuracion_IVA;

DROP table Configuracion_IVA;



-- -----------------------------------------------------
-- Table `guardianvision`.`Detalles_Venta`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Detalles_Venta (
  idDetallesVenta INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  Cantidad FLOAT NOT NULL,
  idProducto VARCHAR(20) NOT NULL,
  idVenta INT NOT NULL,
  FOREIGN KEY (idProducto) REFERENCES Producto(cod_producto)
);


DESCRIBE Detalles_Venta;

DROP table Detalles_Venta;

-- -----------------------------------------------------
-- Table `guardianvision`.`Cliente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Cliente (
  idCliente INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  Nombre VARCHAR(45) NOT NULL,
  Direccion VARCHAR(45) NOT NULL,
  Telefono VARCHAR(45) NOT NULL,
  Email VARCHAR(45) NOT NULL
);


DESCRIBE Clientes;

DROP table Clientes;



-- -----------------------------------------------------
-- Table `guardianvision`.`Envio`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Envio (
  idEnvio INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  Fecha_inicio VARCHAR(45) NOT NULL,
  Fecha_entrega VARCHAR(45) NOT NULL,
  Emprresa_envio VARCHAR(45) NOT NULL,
  Estado VARCHAR(45) NOT NULL
);

DESCRIBE Envio;

DROP table Envio;


-- -----------------------------------------------------
-- Table `guardianvision`.`Instalacion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Instalacion (
  idIntalacion INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  Fecha DATE NOT NULL,
  Direccion VARCHAR(45) NOT NULL,
  Precio FLOAT NOT NULL
);

DESCRIBE Instalacion;

DROP table Instalacion;


-- -----------------------------------------------------
-- Table `guardianvision`.`Venta`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Venta (
  idVenta INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  Fecha DATE NOT NULL,
  pago_total FLOAT NOT NULL,
  forma_pago VARCHAR(45) NOT NULL,
  tipo_envio VARCHAR(45) NOT NULL,
  idIntalacion INT,
  idEnvio INT,
  idDetallesVenta INT NOT NULL,
  idCliente INT NOT NULL,
  idProducto VARCHAR(20) NOT NULL,
  FOREIGN KEY (idIntalacion) REFERENCES Intalacion(idIntalacion),
  FOREIGN KEY (idEnvio) REFERENCES Envio(idEnvio),
  FOREIGN KEY (idDetallesVenta) REFERENCES `Detalles Venta`(idDetallesVenta),
  FOREIGN KEY (idCliente) REFERENCES Cliente(idCliente)
);

DESCRIBE Venta;

DROP table Venta;


-- -----------------------------------------------------
-- Table `guardianvision`.`pedido`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS pedido (
  cod_pedido VARCHAR(45) NOT NULL PRIMARY KEY,
  fecha_pedido VARCHAR(45) NOT NULL,
  cod_proveedor VARCHAR(45) NOT NULL,
  estado ENUM('pendiente', 'recibido', 'cancelado') NOT NULL,
  FOREIGN KEY (cod_proveedor) REFERENCES proveedor(cod_proveedor)
);

DESCRIBE pedido;

DROP table pedido;


-- -----------------------------------------------------
-- Table `guardianvision`.`detalle_pedido`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS detalle_pedido (
  cod_pedido VARCHAR(45) NOT NULL,
  cod_producto VARCHAR(45) NOT NULL,
  cantidad INT NOT NULL,
  precio_unitario DECIMAL NOT NULL,
  PRIMARY KEY (cod_pedido, cod_producto),
  FOREIGN KEY (cod_pedido) REFERENCES pedido(cod_pedido)
);

DESCRIBE detalle_pedido;

DROP table detalle_pedido;


-- -----------------------------------------------------
-- Table `guardianvision`.`Albaran`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Albaran (
  cod_albaran VARCHAR(30) NOT NULL PRIMARY KEY,
  fecha_recepcion DATE NOT NULL,
  cod_pedido VARCHAR(45) NOT NULL,
  estado_recepcion ENUM('pendiente', 'completo') NOT NULL,
  observaciones TEXT NOT NULL,
  FOREIGN KEY (cod_pedido) REFERENCES pedido(cod_pedido)
);


DESCRIBE Albaran;

DROP table Albaran;   


INSERT INTO Almacen ( nombre, direccion, capacidad, capacidad_ocupada)
VALUES 
('Almacén Central', 'Calle Seguridad 123, Madrid', 1000, 350),
('Almacén Sevilla', 'Avenida Videovigilancia 45, Sevilla', 800, 400);


INSERT INTO Producto (cod_producto, nombre, stock_actual, stock_minimo, precio, ubicacion, descripcion)
VALUES 
('CAM123', 'Cámara IP Full HD', 150, 50, 89.99, 1, 'Cámara de vigilancia con resolución Full HD y visión nocturna'),
('KIT456', 'Kit 4 Cámaras + DVR', 40, 10, 299.95, 2, 'Kit completo con 4 cámaras y grabador DVR incluido'),
('SEN789', 'Sensor Movimiento WiFi', 200, 50, 29.90, 1, 'Sensor de movimiento inalámbrico con conectividad WiFi'),
('SEN790', 'Sensor de apertura para puertas/ventanas', 180, 40, 19.90, 1, 'Sensor magnético para detección de aperturas'),
('DVR001', 'Grabador DVR 8 canales con salida HDMI', 60, 15, 159.00, 2, 'DVR para grabación de video con salida HDMI, 8 canales'),
('DISK01', 'Disco Duro 2TB para Videovigilancia', 100, 20, 89.50, 1, 'Disco duro de 2TB optimizado para grabación continua'),
('MIC001', 'Micrófono ambiente para cámaras', 70, 10, 14.99, 2, 'Micrófono para captación de sonido en zonas vigiladas'),
('CAM126', 'Cámara PTZ Motorizada Full HD', 50, 10, 199.99, 1, 'Cámara motorizada PTZ con control remoto y zoom'),
('KIT458', 'Kit de instalación universal', 200, 50, 24.95, 2, 'Accesorios universales para instalación de cámaras'),
('SEN791', 'Sensor de humo inalámbrico', 120, 30, 34.95, 1, 'Detector de humo con señal inalámbrica para alarmas');

INSERT INTO proveedor (cod_proveedor, razon_social, direccion, telefono, email)
VALUES 
('PRO001', 'SegurTech S.A.', 'Pol. Ind. Norte, Barcelona', '912345678', 'contacto@segurtech.com'),
('PRO002', 'VisionMax Ltd.', 'C/ Lentes 33, Valencia', '934567891', 'ventas@visionmax.com');


INSERT INTO Materia_Prima (cod_mp, nombre, unidad_medida, stock_actuall, stock_minimo, proveedor, ubicacion)
VALUES 
('MP001', 'Placa base cámara IP', 'unidad', 500, 100, 'PRO001', 1),
('MP002', 'Lente angular 90°', 'unidad', 300, 80, 'PRO002', 2);


INSERT INTO Cliente (Nombre, Direccion, Telefono, Email)
VALUES 
('Ana López', 'Calle Vigilancia 3, Málaga', '654123456', 'ana.lopez@gmail.com'),
('Carlos Ruiz', 'Av. Seguridad 22, Madrid', '622334455', 'carlos.ruiz@hotmail.com');


INSERT INTO `Detalles Venta` (Cantidad, idProducto, idVenta)
VALUES 
(2, 'CAM123', 1),
(1, 'KIT456', 1);

INSERT INTO Venta (idVenta, Fecha, pago_total, forma_pago, tipo_envio, idDetallesVenta, idCliente, idProducto)
VALUES 
(1, '2025-05-10', 479.93, 'Tarjeta', 'Estándar', 1, 1, 'CAM123');


INSERT INTO pedido (cod_pedido, fecha_pedido, cod_proveedor, estado)
VALUES 
('PED001', '2025-05-05', 'PRO001', 'pendiente');

INSERT INTO detalle_pedido (cod_pedido, cod_producto, cantidad, precio_unitario)
VALUES 
('PED001', 'CAM123', 100, 60.00);


INSERT INTO Albaran (cod_albaran, fecha_recepcion, cod_pedido, estado_recepcion, observaciones)
VALUES 
('ALB001', '2025-05-08', 'PED001', 'pendiente', 'Revisar embalaje al recibir');
